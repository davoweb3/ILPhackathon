{"ast":null,"code":"/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n        const validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}","map":{"version":3,"names":["utils","filterIceServers","iceServers","edgeVersion","hasTurn","JSON","parse","stringify","filter","server","urls","url","deprecated","isString","indexOf","validTurn","startsWith","includes","length"],"sources":["/home/cedarmat/rezy2/rezyonrafiki/Rezy/Frontend/Rezy barcode/scanner/scanner/node_modules/webrtc-adapter/src/js/edge/filtericeservers.js"],"sourcesContent":["/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') &&\n            !url.startsWith('turn:[') &&\n            url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZ,OAAO,KAAKA,KAAK,MAAM,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,gBAAgBA,CAACC,UAAU,EAAEC,WAAW,EAAE;EACxD,IAAIC,OAAO,GAAG,KAAK;EACnBF,UAAU,GAAGG,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACL,UAAU,CAAC,CAAC;EACnD,OAAOA,UAAU,CAACM,MAAM,CAACC,MAAM,IAAI;IACjC,IAAIA,MAAM,KAAKA,MAAM,CAACC,IAAI,IAAID,MAAM,CAACE,GAAG,CAAC,EAAE;MACzC,IAAID,IAAI,GAAGD,MAAM,CAACC,IAAI,IAAID,MAAM,CAACE,GAAG;MACpC,IAAIF,MAAM,CAACE,GAAG,IAAI,CAACF,MAAM,CAACC,IAAI,EAAE;QAC9BV,KAAK,CAACY,UAAU,CAAC,kBAAkB,EAAE,mBAAmB,CAAC;MAC3D;MACA,MAAMC,QAAQ,GAAG,OAAOH,IAAI,KAAK,QAAQ;MACzC,IAAIG,QAAQ,EAAE;QACZH,IAAI,GAAG,CAACA,IAAI,CAAC;MACf;MACAA,IAAI,GAAGA,IAAI,CAACF,MAAM,CAACG,GAAG,IAAI;QACxB;QACA,IAAIA,GAAG,CAACG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;UAC9B,OAAO,KAAK;QACd;QAEA,MAAMC,SAAS,GAAGJ,GAAG,CAACK,UAAU,CAAC,MAAM,CAAC,IACpC,CAACL,GAAG,CAACK,UAAU,CAAC,QAAQ,CAAC,IACzBL,GAAG,CAACM,QAAQ,CAAC,eAAe,CAAC;QACjC,IAAIF,SAAS,IAAI,CAACX,OAAO,EAAE;UACzBA,OAAO,GAAG,IAAI;UACd,OAAO,IAAI;QACb;QACA,OAAOW,SAAS,IAAI,CAACX,OAAO;MAC9B,CAAC,CAAC;MAEF,OAAOK,MAAM,CAACE,GAAG;MACjBF,MAAM,CAACC,IAAI,GAAGG,QAAQ,GAAGH,IAAI,CAAC,CAAC,CAAC,GAAGA,IAAI;MACvC,OAAO,CAAC,CAACA,IAAI,CAACQ,MAAM;IACtB;EACF,CAAC,CAAC;AACJ"},"metadata":{},"sourceType":"module"}