{"ast":null,"code":"\"use strict\";\n\n/*\n * Copyright 2007 ZXing authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*namespace com.google.zxing.common {*/\n/**\n * <p>This class implements a perspective transform in two dimensions. Given four source and four\n * destination points, it will compute the transformation implied between them. The code is based\n * directly upon section 3.4.2 of George Wolberg's \"Digital Image Warping\"; see pages 54-56.</p>\n *\n * @author Sean Owen\n */\nvar PerspectiveTransform = /** @class */function () {\n  function PerspectiveTransform(a11 /*float*/, a21 /*float*/, a31 /*float*/, a12 /*float*/, a22 /*float*/, a32 /*float*/, a13 /*float*/, a23 /*float*/, a33 /*float*/) {\n    this.a11 = a11;\n    this.a21 = a21;\n    this.a31 = a31;\n    this.a12 = a12;\n    this.a22 = a22;\n    this.a32 = a32;\n    this.a13 = a13;\n    this.a23 = a23;\n    this.a33 = a33;\n  }\n  PerspectiveTransform.quadrilateralToQuadrilateral = function (x0 /*float*/, y0 /*float*/, x1 /*float*/, y1 /*float*/, x2 /*float*/, y2 /*float*/, x3 /*float*/, y3 /*float*/, x0p /*float*/, y0p /*float*/, x1p /*float*/, y1p /*float*/, x2p /*float*/, y2p /*float*/, x3p /*float*/, y3p /*float*/) {\n    var qToS = PerspectiveTransform.quadrilateralToSquare(x0, y0, x1, y1, x2, y2, x3, y3);\n    var sToQ = PerspectiveTransform.squareToQuadrilateral(x0p, y0p, x1p, y1p, x2p, y2p, x3p, y3p);\n    return sToQ.times(qToS);\n  };\n  PerspectiveTransform.prototype.transformPoints = function (points) {\n    var max = points.length;\n    var a11 = this.a11;\n    var a12 = this.a12;\n    var a13 = this.a13;\n    var a21 = this.a21;\n    var a22 = this.a22;\n    var a23 = this.a23;\n    var a31 = this.a31;\n    var a32 = this.a32;\n    var a33 = this.a33;\n    for (var i = 0; i < max; i += 2) {\n      var x = points[i];\n      var y = points[i + 1];\n      var denominator = a13 * x + a23 * y + a33;\n      points[i] = (a11 * x + a21 * y + a31) / denominator;\n      points[i + 1] = (a12 * x + a22 * y + a32) / denominator;\n    }\n  };\n  PerspectiveTransform.prototype.transformPointsWithValues = function (xValues, yValues) {\n    var a11 = this.a11;\n    var a12 = this.a12;\n    var a13 = this.a13;\n    var a21 = this.a21;\n    var a22 = this.a22;\n    var a23 = this.a23;\n    var a31 = this.a31;\n    var a32 = this.a32;\n    var a33 = this.a33;\n    var n = xValues.length;\n    for (var i = 0; i < n; i++) {\n      var x = xValues[i];\n      var y = yValues[i];\n      var denominator = a13 * x + a23 * y + a33;\n      xValues[i] = (a11 * x + a21 * y + a31) / denominator;\n      yValues[i] = (a12 * x + a22 * y + a32) / denominator;\n    }\n  };\n  PerspectiveTransform.squareToQuadrilateral = function (x0 /*float*/, y0 /*float*/, x1 /*float*/, y1 /*float*/, x2 /*float*/, y2 /*float*/, x3 /*float*/, y3 /*float*/) {\n    var dx3 = x0 - x1 + x2 - x3;\n    var dy3 = y0 - y1 + y2 - y3;\n    if (dx3 === 0.0 && dy3 === 0.0) {\n      // Affine\n      return new PerspectiveTransform(x1 - x0, x2 - x1, x0, y1 - y0, y2 - y1, y0, 0.0, 0.0, 1.0);\n    } else {\n      var dx1 = x1 - x2;\n      var dx2 = x3 - x2;\n      var dy1 = y1 - y2;\n      var dy2 = y3 - y2;\n      var denominator = dx1 * dy2 - dx2 * dy1;\n      var a13 = (dx3 * dy2 - dx2 * dy3) / denominator;\n      var a23 = (dx1 * dy3 - dx3 * dy1) / denominator;\n      return new PerspectiveTransform(x1 - x0 + a13 * x1, x3 - x0 + a23 * x3, x0, y1 - y0 + a13 * y1, y3 - y0 + a23 * y3, y0, a13, a23, 1.0);\n    }\n  };\n  PerspectiveTransform.quadrilateralToSquare = function (x0 /*float*/, y0 /*float*/, x1 /*float*/, y1 /*float*/, x2 /*float*/, y2 /*float*/, x3 /*float*/, y3 /*float*/) {\n    // Here, the adjoint serves as the inverse:\n    return PerspectiveTransform.squareToQuadrilateral(x0, y0, x1, y1, x2, y2, x3, y3).buildAdjoint();\n  };\n  PerspectiveTransform.prototype.buildAdjoint = function () {\n    // Adjoint is the transpose of the cofactor matrix:\n    return new PerspectiveTransform(this.a22 * this.a33 - this.a23 * this.a32, this.a23 * this.a31 - this.a21 * this.a33, this.a21 * this.a32 - this.a22 * this.a31, this.a13 * this.a32 - this.a12 * this.a33, this.a11 * this.a33 - this.a13 * this.a31, this.a12 * this.a31 - this.a11 * this.a32, this.a12 * this.a23 - this.a13 * this.a22, this.a13 * this.a21 - this.a11 * this.a23, this.a11 * this.a22 - this.a12 * this.a21);\n  };\n  PerspectiveTransform.prototype.times = function (other) {\n    return new PerspectiveTransform(this.a11 * other.a11 + this.a21 * other.a12 + this.a31 * other.a13, this.a11 * other.a21 + this.a21 * other.a22 + this.a31 * other.a23, this.a11 * other.a31 + this.a21 * other.a32 + this.a31 * other.a33, this.a12 * other.a11 + this.a22 * other.a12 + this.a32 * other.a13, this.a12 * other.a21 + this.a22 * other.a22 + this.a32 * other.a23, this.a12 * other.a31 + this.a22 * other.a32 + this.a32 * other.a33, this.a13 * other.a11 + this.a23 * other.a12 + this.a33 * other.a13, this.a13 * other.a21 + this.a23 * other.a22 + this.a33 * other.a23, this.a13 * other.a31 + this.a23 * other.a32 + this.a33 * other.a33);\n  };\n  return PerspectiveTransform;\n}();\nexports.default = PerspectiveTransform;","map":{"version":3,"names":["PerspectiveTransform","a11","a21","a31","a12","a22","a32","a13","a23","a33","quadrilateralToQuadrilateral","x0","y0","x1","y1","x2","y2","x3","y3","x0p","y0p","x1p","y1p","x2p","y2p","x3p","y3p","qToS","quadrilateralToSquare","sToQ","squareToQuadrilateral","times","prototype","transformPoints","points","max","length","i","x","y","denominator","transformPointsWithValues","xValues","yValues","n","dx3","dy3","dx1","dx2","dy1","dy2","buildAdjoint","other"],"sources":["../../../src/core/common/PerspectiveTransform.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script"}